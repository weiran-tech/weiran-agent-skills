# HLD 模板：新功能（有 UI）

> 以下为模板内容，复制后根据实际情况填写。

---

# [功能名称] 技术设计文档

## 元信息

| 项目 | 内容 |
|------|------|
| 关联 PRD | [PRD 文档链接] |
| 版本 | v1.0 |
| 作者 | [作者] |
| 创建日期 | [日期] |
| 状态 | 草稿/评审中/已批准 |

## PRD↔HLD 需求映射表

**本 HLD 覆盖范围**：[范围]（1:N 场景必填）
**索引文档**：[HLD-INDEX-xxx.md](路径)（1:N 场景必填）

| PRD 条目 | 验收标准 | HLD 章节 | 状态 |
|----------|---------|---------|------|
| [FR-XXX] | [验收标准] | [对应章节] | ✓/进行中/待定 |

## 1. 背景与目标

### 1.1 业务背景
[简要描述业务背景，引用 PRD]

### 1.2 技术目标
- [技术目标 1]
- [技术目标 2]

### 1.3 非功能目标
| 指标 | 目标值 | 来源 |
|------|--------|------|
| 响应时间 | < Xms | PRD 约束 |
| 并发量 | X QPS | PRD 约束 |

### 1.4 技术现状与变更（如为已有系统新增功能）

#### 受影响的技术组件
| 组件 | 当前状态 | 变更内容 |
|------|----------|---------|
| [组件] | [当前] | [变更] |

#### 架构变更概述
[描述对现有架构的影响，如为全新系统可标注"不适用"]

## 2. 技术架构

### 2.1 整体架构

```mermaid
graph TB
    subgraph 前端
        A[Web App] --> B[API Gateway]
    end
    subgraph 后端
        B --> C[Service A]
        B --> D[Service B]
        C --> E[(Database)]
    end
```

### 2.2 复用盘点

| 能力需求 | 候选方案 | 评估结论 | 来源 |
|---------|---------|---------|------|
| [能力1] | 内部模块 A / 第三方 B / 自研 | [选择及理由] | [文档/代码路径] |
| [能力2] | 共享服务 X / 自研 | [选择及理由] | [文档/代码路径] |

> 说明：
> - 优先复用内部模块/共享服务/第三方成熟方案，自研需给出充分理由
> - **「来源」列必填**：必须注明从哪个文档或代码中识别到该候选方案，禁止无依据猜测

### 2.3 技术选型

| 组件 | 选型 | 理由 |
|------|------|------|
| 前端框架 | [选型] | [理由] |
| 后端框架 | [选型] | [理由] |
| 数据库 | [选型] | [理由] |
| 缓存 | [选型] | [理由] |

## 3. 前端设计

### 3.1 页面结构
[页面层级、路由设计]

### 3.2 状态管理
[状态管理策略]

### 3.3 与后端交互
[API 调用方式、错误处理策略]

## 4. API 设计

> **注意**：若项目已有 OpenAPI/Swagger 规范，优先引用已有规范路径，避免重复维护。
> - 已有规范：填写「详见 `path/to/openapi.yaml#/paths/xxx`」
> - 新增接口：按下方模板填写详情

### 4.1 接口列表

| 接口 | 方法 | 路径 | 说明 | 规范位置 |
|------|------|------|------|----------|
| [接口1] | POST | /api/v1/xxx | [说明] | 新增 / 详见 `openapi.yaml#L100` |
| [接口2] | GET | /api/v1/xxx | [说明] | 新增 / 详见 `openapi.yaml#L150` |

### 4.2 认证授权
[认证方式、权限控制策略]

### 4.3 接口详情

> 仅对**新增接口**填写详情，已有规范的接口请引用规范路径。

#### POST /api/v1/xxx（新增）

**请求体**：
```json
{
  "field1": "string",
  "field2": "number"
}
```

**响应体**：
```json
{
  "code": 0,
  "data": {}
}
```

## 5. 数据设计

### 5.1 数据模型（概念级）

```mermaid
erDiagram
    EntityA ||--o{ EntityB : contains
    EntityA ||--|| EntityC : references
```

| 实体 | 说明 | 核心属性（概念） |
|------|------|-----------------|
| EntityA | [实体说明] | ID、名称、创建时间 |
| EntityB | [实体说明] | ID、关联A、状态 |

> 注意：此处为概念模型，具体字段类型、长度等属于 LLD

### 5.2 索引策略
| 实体 | 索引策略 | 用途 |
|------|---------|------|
| [实体] | [策略描述] | [用途] |

### 5.3 数据迁移策略
[是否需要迁移、迁移策略]

## 6. 关键流程

### 6.1 [核心流程名称]

```mermaid
sequenceDiagram
    participant U as 用户
    participant F as 前端
    participant B as 后端
    participant D as 数据库

    U->>F: 操作
    F->>B: API 请求
    B->>D: 查询/写入
    D-->>B: 返回
    B-->>F: 响应
    F-->>U: 展示结果
```

## 7. 非功能设计

### 7.1 性能策略
- 缓存策略：[策略描述]
- 分页策略：[策略描述]

### 7.2 安全策略
- 认证：[策略]
- 数据脱敏：[策略]

### 7.3 可观测性
- 日志：[策略]
- 监控：[关键指标]
- 告警：[告警规则]

## 8. 部署架构

### 8.1 部署拓扑
[部署图或描述]

### 8.2 环境配置
| 环境 | 配置差异 |
|------|---------|
| 开发 | [配置] |
| 测试 | [配置] |
| 生产 | [配置] |

### 8.3 兼容性设计（承接 PRD 兼容性要求）

| PRD 兼容性要求 | 技术实现方案 |
|---------------|-------------|
| [旧版本客户端兼容] | [技术方案] |
| [现有数据兼容] | [技术方案] |

### 8.4 发布策略

| 策略 | 设计 |
|------|------|
| 灰度方案 | [灰度范围、灰度条件] |
| 功能开关 | [开关设计，如需要] |
| 回滚方案 | [回滚步骤、回滚条件] |

### 8.5 埋点/监控设计（承接 PRD 成功指标）

| PRD 成功指标 | 埋点/监控设计 |
|-------------|--------------|
| [指标名] | [采集方式、存储、展示] |

## 9. 风险与依赖

### 9.1 技术风险
| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| [风险] | [影响] | [措施] |

### 9.2 外部依赖
| 依赖 | 负责团队 | 状态 |
|------|---------|------|
| [依赖] | [团队] | [状态] |

## 10. 里程碑

| 阶段 | 交付物 | 负责人 |
|------|--------|--------|
| 阶段 1 | [交付物] | [负责人] |
