# LLD 审查报告与准出证书模板

本文档提供 LLD 审查的标准输出模板。

---

## 审查报告模板

### 完整报告（通用）

```markdown
# LLD 审查报告

## 基本信息

| 项目 | 内容 |
|------|------|
| **LLD 文档** | {文件路径} |
| **PRD 基线** | {文件路径} v{版本} |
| **HLD 基线** | {文件路径} v{版本} |
| **API Contract** | {文件路径} v{版本} |
| **Guardrails** | {文件路径} / N/A |
| **审查时间** | {YYYY-MM-DD HH:MM} |
| **审查轮次** | 第 {N} 轮 |
| **审查结论** | 🟢 通过 / 🔴 不通过 |

---

## 问题统计

| 级别 | 数量 | 门槛 | 状态 |
|------|------|------|------|
| P0（阻断） | {n} | = 0 | ✅ 通过 / ❌ 未通过 |
| P1（严重） | {n} | = 0 | ✅ 通过 / ❌ 未通过 |
| P2（建议） | {n} | ≤ 2 | ✅ 通过 / ❌ 未通过 |

---

## Gate 1：基线与 Manifest 检查

### 基线引用检查

| 检查项 | 结果 | 证据位置 | 问题 |
|--------|------|----------|------|
| PRD 版本标注 | ✅/⚠️/❌ | LLD:{章节} | {问题描述} |
| HLD 版本标注 | ✅/⚠️/❌ | LLD:{章节} | {问题描述} |
| Contract 版本标注 | ✅/⚠️/❌ | LLD:{章节} | {问题描述} |

### Manifest 完整性检查

| 模块 | 状态 | N/A 理由 | 检查结果 |
|------|------|----------|----------|
| Core | Included | — | ✅ |
| API Contract | Included | — | ✅ |
| Storage & Migration | Excluded | {理由} | ✅/⚠️ |
| Async/Event | Excluded | {理由} | ✅/⚠️ |
| Infra/IaC | Included | — | ✅ |
| Observability | Included | — | ✅/⚠️ |
| Security/Compliance | Excluded | {理由} | ✅/⚠️ |
| Deployment/Release | Included | — | ✅/⚠️ |
| Frontend UX | Excluded | {理由} | ✅/⚠️ |
| External Integration | Excluded | {理由} | ✅/⚠️ |
| SDK/Library | Excluded | {理由} | ✅/⚠️ |

### Guardrails 覆盖检查

| Guardrail 要求 | LLD 覆盖位置 | 结果 |
|----------------|--------------|------|
| {要求1} | LLD:{章节} | ✅/❌ |
| {要求2} | LLD:{章节} | ✅/❌ |

### 新边界检测

| 检测项 | 结果 | 证据 |
|--------|------|------|
| 新服务引入 | ✅ 无 / ❌ 有 | {证据描述} |
| 新接口引入 | ✅ 无 / ❌ 有 | {证据描述} |
| 新边界引入 | ✅ 无 / ❌ 有 | {证据描述} |

**Gate 1 结论**：✅ 通过 / ❌ P0 阻塞

---

## Gate 2：一致性与漂移检测

### HLD→LLD 覆盖表

| HLD 设计决策 | LLD 覆盖位置 | 状态 | 说明 |
|--------------|-------------|------|------|
| HLD:{章节} {决策描述} | LLD:{章节} | ✅ 已覆盖 | — |
| HLD:{章节} {决策描述} | LLD:{章节} | ⚠️ 部分覆盖 | {说明} |
| HLD:{章节} {决策描述} | — | ❌ 未覆盖 | {说明} |

**覆盖率**：{已覆盖数}/{总数} = {百分比}%

### 漂移问题清单

| # | 类型 | HLD 位置 | LLD 位置 | 描述 | 严重度 |
|---|------|----------|----------|------|--------|
| 1 | 遗漏 | HLD:{位置} | — | {描述} | P0 |
| 2 | 膨胀 | — | LLD:{位置} | {描述} | P1 |
| 3 | 变形 | HLD:{位置} | LLD:{位置} | {描述} | P1 |
| 4 | 降级 | HLD:{位置} | LLD:{位置} | {描述} | P1 |

### Contract 一致性检查

| 接口 | Contract 定义 | LLD 定义 | 结果 | 问题 |
|------|--------------|----------|------|------|
| {接口名} | Contract:{位置} | LLD:{位置} | ✅/❌ | {问题} |

**Gate 2 结论**：✅ 无漂移 / ⚠️ 存在漂移

---

## Gate 3：模块完整性检查

| 模块 | 状态 | 必填项 | 缺失项 | 严重度 |
|------|------|--------|--------|--------|
| Core | Included | 5/5 | — | — |
| API Contract | Included | 3/3 | — | — |
| Storage & Migration | Included | 4/4 | — | — |
| Async/Event | Included | 4/4 | — | — |
| Infra/IaC | Included | 3/3 | — | — |
| Observability | Included | 4/4 | — | — |
| Security/Compliance | Included | 3/3 | — | — |
| Deployment/Release | Included | 3/3 | — | — |
| Frontend UX | Included | 4/4 | — | — |
| External Integration | Included | 3/3 | — | — |
| SDK/Library | Included | 3/3 | — | — |

**Gate 3 结论**：✅ 完整 / ⚠️ 存在缺失

---

## Gate 4：可实现性与风险评估

| 评估项 | 结果 | 证据位置 | 问题 |
|--------|------|----------|------|
| 关键流程伪代码 | ✅/⚠️/❌ | LLD:{位置} | {问题} |
| 错误处理完整性 | ✅/⚠️/❌ | LLD:{位置} | {问题} |
| 并发/事务/幂等 | ✅/⚠️/❌ | LLD:{位置} | {问题} |
| 测试策略可行性 | ✅/⚠️/❌ | LLD:{位置} | {问题} |
| 观测设计 | ✅/⚠️/❌ | LLD:{位置} | {问题} |
| 发布策略 | ✅/⚠️/❌ | LLD:{位置} | {问题} |

**Gate 4 结论**：✅ 可实现 / ⚠️ 存在风险

---

## 问题清单汇总

### 🔴 P0 阻塞问题（必须修复）

| # | Gate | 问题描述 | 证据位置 | 建议修改 |
|---|------|----------|----------|----------|
| 1 | Gate 1 | {描述} | LLD:{位置} | {建议} |
| 2 | Gate 2 | {描述} | HLD:{位置} vs LLD:{位置} | {建议} |

### 🟡 P1 严重问题（必须修复）

| # | Gate | 问题描述 | 证据位置 | 建议修改 |
|---|------|----------|----------|----------|
| 1 | Gate 2 | {描述} | LLD:{位置} | {建议} |
| 2 | Gate 3 | {描述} | LLD:{位置} | {建议} |

### 🔵 P2 建议问题（可选优化）

| # | Gate | 问题描述 | 证据位置 | 建议修改 |
|---|------|----------|----------|----------|
| 1 | Gate 4 | {描述} | LLD:{位置} | {建议} |

---

## 放行决策

### 准出门槛检查

| 门槛 | 要求 | 实际 | 状态 |
|------|------|------|------|
| P0 | = 0 | {n} | ✅/❌ |
| P1 | = 0 | {n} | ✅/❌ |
| P2 | ≤ 2 | {n} | ✅/❌ |

### 结论

**🟢 通过**：符合准出标准，可进入代码实现阶段。

或

**🔴 不通过**：存在 {n} 个 P0 问题、{n} 个 P1 问题，需修复后复审。

---

## 下一步

### 若通过
- 进入代码实现阶段
- 保留本报告作为设计基线
- 实现时参考 LLD 设计

### 若不通过
1. LLD 作者修复以下问题：
   - {问题1}
   - {问题2}
2. 修复完成后，发起复审（轮次 +1）
3. 复审将重新执行四道门检查
```

---

## 准出证书模板

### 通过时输出

```markdown
# ✅ LLD 准出证书

---

## 基本信息

| 项目 | 内容 |
|------|------|
| **LLD 文档** | {文件路径} |
| **PRD 基线** | {文件路径} v{版本} |
| **HLD 基线** | {文件路径} v{版本} |
| **API Contract** | {文件路径} v{版本} |
| **准出时间** | {YYYY-MM-DD HH:MM} |
| **审查轮次** | 共 {N} 轮 |
| **审查结论** | 🟢 **通过** |

---

## 审查历程

| 轮次 | 日期 | P0 | P1 | P2 | 结论 |
|------|------|----|----|----| -----|
| 1 | {YYYY-MM-DD} | 2 | 3 | 1 | 🔴 不通过 |
| 2 | {YYYY-MM-DD} | 0 | 1 | 2 | 🔴 不通过 |
| 3 | {YYYY-MM-DD} | 0 | 0 | 1 | 🟢 通过 |

---

## 一致性确认

- ✅ HLD→LLD 覆盖率 100%
- ✅ 无需求遗漏（HLD 设计全部覆盖）
- ✅ 无未标注的需求膨胀
- ✅ 无需求变形
- ✅ 无质量降级
- ✅ API Contract 100% 一致

---

## 准出门槛确认

| 门槛 | 要求 | 实际 | 状态 |
|------|------|------|------|
| P0 | = 0 | 0 | ✅ |
| P1 | = 0 | 0 | ✅ |
| P2 | ≤ 2 | {n} | ✅ |

---

## 审查覆盖

- ✅ **Gate 1**：基线与 Manifest 检查完成
- ✅ **Gate 2**：一致性与漂移检测完成
- ✅ **Gate 3**：模块完整性检查完成
- ✅ **Gate 4**：可实现性与风险评估完成

---

## 遗留建议（P2）

以下问题不阻塞放行，建议在实现阶段优化：

| # | 问题 | 建议 |
|---|------|------|
| 1 | {P2 问题描述} | {优化建议} |

---

## 准出确认

本 LLD 已通过 **lld-reviewer** 全面审查，符合准出标准。

### ✅ 可以进入代码实现阶段

---

**审查者**：lld-reviewer

**准出签章**：`PASSED-{YYYYMMDD}-{MD5(LLD文件名)前6位}`

示例：`PASSED-20250115-a3f2b1`
```

---

## 阻塞报告模板（Gate 1 P0）

当 Gate 1 存在 P0 问题时，立即停止审查，输出简化报告：

```markdown
# LLD 审查报告 - Gate 1 阻塞

## 基本信息

| 项目 | 内容 |
|------|------|
| **LLD 文档** | {文件路径} |
| **审查时间** | {YYYY-MM-DD HH:MM} |
| **审查结论** | 🔴 **Gate 1 阻塞** |

---

## Gate 1 阻塞原因

| # | 问题 | 严重度 | 说明 |
|---|------|--------|------|
| 1 | {问题描述} | P0 | {详细说明} |

---

## 下一步

1. 修复 Gate 1 P0 问题
2. 重新发起 LLD 审查
3. 审查将从 Gate 1 重新开始

---

**注意**：由于 Gate 1 存在 P0 阻塞问题，Gate 2/3/4 未执行。
```

---

## 使用说明

1. **选择模板**：根据审查结果选择对应模板
2. **填充内容**：替换 `{占位符}` 为实际内容
3. **保持格式**：严格遵循表格和章节结构
4. **证据引用**：所有问题必须指向具体位置（如 `LLD:3.2`、`HLD:4.1`）
